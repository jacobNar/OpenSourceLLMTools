import torch
from transformers import pipeline
print(torch.cuda.is_available())  
pipe = pipeline(
    "text-generation",
    model="google/gemma-2-2b-it",
    model_kwargs={"torch_dtype": torch.bfloat16},
    device="cuda",  # replace with "mps" to run on a Mac device
)

messages = [
    {"role": "user", "content": "You are an AI that extracts structured betting information from noisy input text. you will be passed in a parsed text from a screenshot of a sportsbetting site. The sites will have the following information in each row, home and away team, game time, and odds for moneylines, spreads, and total bets."},
    {"role": "assistant", "content": "sure thing"},
    {"role": "user", "content": "NFL\née. Cleveland Browns\n\n&> Denver Broncos\n(ED von 7:15PM cr\n\n© Green Bay Packers\n\n»\\F Detroit Lions\n\n(GD teu 7-150 cr\nVs] Las Vegas Raiders\n\nay Tampa Bay Buccaneers\n\n(GD vec 8, 12:00PM ct\n\née. Cleveland Browns\n\n(Ss) Pittsburgh Steelers\n\n(GD vec 8, 12:00PM ct\neS Jacksonville Jaguars\n\nB® Tennessee Titans\n\n(GD vec 8, 12:00PM ct\n\nM@ Carolina Panthers\n\nSPREAD MONEY TOTAL\n455 0425\n“105 +210 “105\n55 u425\n15 7285 15\nStats Y More wagers >\n43.5 515\n“105 +168 “110\n35 U515\n15 ~200 -110\nStats Y More wagers >\n+7 044.5\n% +280 te\n7 u44s\n-110 “350 -110\nStats Y More wagers >\n46.5 0415\n+65 4235 os\n65 uats\n-110 ~290 “110\nStats Y More wagers >\n44.5 0.40.5\n“115 +176 “105\nAS u405\n105 -210 15\nStats Y More wagers >\n+25 0455\n“105\n\n110\niets Explorer\n\n"},
    {"role": "assistant", "content": '{ "games": [ { "sport": "NFL", "gameTime": "MON 7:15PM CT", "awayTeam": "Cleveland Browns", "homeTeam": "Denver Broncos", "spread": { "fanduel": { "favorite": { "odds": -115, "value": "-5.5", "pick": "Denver Broncos" }, "underdog": { "odds": -105, "value": "+5.5", "pick": "Cleveland Browns" } } }, "moneyline": { "fanduel": { "favorite": { "odds": -255, "value": null, "pick": "Denver Broncos" }, "underdog": { "odds": 210, "value": null, "pick": "Cleveland Browns" } } }, "totals": { "fanduel": { "favorite": { "odds": -115, "value": "42.5", "pick": "U" }, "underdog": { "odds": -105, "value": "42.5", "pick": "O" } } } }, { "sport": "NFL", "gameTime": "THU 7:15PM CT", "awayTeam": "Green Bay Packers", "homeTeam": "Detroit Lions", "spread": { "fanduel": { "favorite": { "odds": -115, "value": "-3.5", "pick": "Detroit Lions" }, "underdog": { "odds": -105, "value": "+3.5", "pick": "Green Bay Packers" } } }, "moneyline": { "fanduel": { "favorite": { "odds": -200, "value": null, "pick": "Detroit Lions" }, "underdog": { "odds": 168, "value": null, "pick": "Green Bay Packers" } } }, "totals": { "fanduel": { "favorite": { "odds": -110, "value": "51.5", "pick": "U" }, "underdog": { "odds": -110, "value": "51.5", "pick": "O" } } } }, { "sport": "NFL", "gameTime": "DEC 8, 12:00PM CT", "awayTeam": "Las Vegas Raiders", "homeTeam": "Tampa Bay Buccaneers", "spread": { "fanduel": { "favorite": { "odds": -110, "value": "-7", "pick": "Tampa Bay Buccaneers" }, "underdog": { "odds": -110, "value": "+7", "pick": "Las Vegas Raiders" } } }, "moneyline": { "fanduel": { "favorite": { "odds": -350, "value": null, "pick": "Tampa Bay Buccaneers" }, "underdog": { "odds": 280, "value": null, "pick": "Las Vegas Raiders" } } }, "totals": { "fanduel": { "favorite": { "odds": -110, "value": "44.5", "pick": "U" }, "underdog": { "odds": -110, "value": "44.5", "pick": "O" } } } }, { "sport": "NFL", "gameTime": "DEC 8, 12:00PM CT", "awayTeam": "Cleveland Browns", "homeTeam": "Pittsburgh Steelers", "spread": { "fanduel": { "favorite": { "odds": -110, "value": "-6.5", "pick": "Pittsburgh Steelers" }, "underdog": { "odds": -110, "value": "+6.5", "pick": "Cleveland Browns" } } }, "moneyline": { "fanduel": { "favorite": { "odds": -290, "value": null, "pick": "Pittsburgh Steelers" }, "underdog": { "odds": 235, "value": null, "pick": "Cleveland Browns" } } }, "totals": { "fanduel": { "favorite": { "odds": -110, "value": "41.5", "pick": "U" }, "underdog": { "odds": -110, "value": "41.5", "pick": "O" } } } }, { "sport": "NFL", "gameTime": "DEC 8, 12:00PM CT", "awayTeam": "Jacksonville Jaguars", "homeTeam": "Tennessee Titans", "spread": { "fanduel": { "favorite": { "odds": -105, "value": "-4.5", "pick": "Tennessee Titans" }, "underdog": { "odds": -115, "value": "+4.5", "pick": "Jacksonville Jaguars" } } }, "moneyline": { "fanduel": { "favorite": { "odds": -210, "value": null, "pick": "Tennessee Titans" }, "underdog": { "odds": 176, "value": null, "pick": "Jacksonville Jaguars" } } }, "totals": { "fanduel": { "favorite": { "odds": -115, "value": "40.5", "pick": "U" }, "underdog": { "odds": -105, "value": "40.5", "pick": "O" } } } }, { "sport": "NFL", "gameTime": "DEC 8, 12:00PM CT", "awayTeam": "Carolina Panthers", "homeTeam": null, "spread": { "fanduel": { "favorite": { "odds": -110, "value": "-12.5", "pick": null }, "underdog": { "odds": -105, "value": "+12.5", "pick": "Carolina Panthers" } } }, "moneyline": { "fanduel": { "favorite": { "odds": null, "value": null, "pick": null }, "underdog": { "odds": 570, "value": null, "pick": "Carolina Panthers" } } }, "totals": { "fanduel": { "favorite": { "odds": -110, "value": "45.5", "pick": "U" }, "underdog": { "odds": -105, "value": "45.5", "pick": "O" } } } } ]}'},
    {"role": "user" , "content": "eee OO a... I , Games Parlay Builder NBACup NBAFinals Conference Division Season Awards Regulé NBA Odds NBA SPREAD MONEY TOTAL a +10 0 220 €& Miami Heat 10 +350 “M2 -10 u220 -110 =“ -108 Stats Y More wagers > +10 0229.5 -112 “ey “110 -10 U 2295 108 —_ “110 Stats Y More wagers > s +8 0219 &@ Los Angeles Lakers 110 +270 “A10 it i 8 u219 @ Minnesota Timberwolves Bot -335 Mio Stats Y More wagers > +75 0233.5 108 — “110 ea ee 15 U 233.5 T Chicago Bulls a5 -330 fer Stats Y More wagers > Sportsbook Odds / NBA Odds Today's NBA Odds - Bet on NBA Spreads, Moneylines and Live Odds At FanDuel!l Sportsbook. we provide a user-friendly platform for basketball fans eager to bet on NBA odds throuchout the season. Our online"}
]

outputs = pipe(messages, max_new_tokens=1024)
assistant_response = outputs[0]["generated_text"][-1]["content"].strip()
print(assistant_response)